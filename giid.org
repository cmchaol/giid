* Dockerfile

** v.2

#+HEADER:  :tangle Dockerfile
#+BEGIN_SRC sh
FROM gentoo/stage3-amd64-hardened

RUN mkdir /usr/portage; \
    emerge-webrsync; \
    emerge net-misc/proxychains
#+END_SRC


** v.1

#+HEADER:  :tangle Dockerfile
#+BEGIN_SRC sh
FROM gentoo/stage3-amd64-hardened

RUN mkdir /usr/portage; \
    emerge-webrsync
#+END_SRC


** push

| publishing the above block |
| C-u C-c C-v t              |
|                            |
| stage                      |
|                            |
| M-x magit-tag              |
|                            |
| git push master            |
|                            |
| git push a tag             |
|                            |
| observing autmoated build  |


* reference

** gentoo/stage3-amd64-hardened Dockerfile

https://hub.docker.com/r/gentoo/stage3-amd64-hardened/~/dockerfile/

FROM busybox

MAINTAINER Gentoo Docker Team

# This one should be present by running the build.sh script
ADD build.sh /

RUN /build.sh amd64 x86_64 -hardened

# Setup the rc_sys
RUN sed -e 's/#rc_sys=""/rc_sys="docker"/g' -i /etc/rc.conf

# By default, UTC system
RUN echo 'UTC' > /etc/timezone




** pallavagarwal07/gentoo-stabilization

FROM gentoo/stage3-amd64
RUN mkdir -p /root/build; \
    mkdir /usr/portage; \
    emerge-webrsync; \
    eselect python set python2.7; \
    echo 'MAKEOPTS="-j4"' >> /etc/portage/make.conf; \
    emerge --autounmask-write dev-vcs/git \
                              dev-python/numpy \
                              dev-python/requests \
                              app-portage/portage-utils; \
    yes | etc-update --automode -3; \
    emerge --autounmask-write dev-vcs/git \
                              dev-python/numpy \
                              dev-python/requests \
                              app-portage/portage-utils; \
    easy_install satispy; \
    easy_install pycosat; \
    cd /usr/portage; \
    rm -rf `ls -1A | grep -vP '^profiles'`;
COPY scripts/ControlContainer/*.py scripts/ControlContainer/*.sh /root/
COPY etc_portage /etc/portage/
CMD ["/root/logger.sh"]

https://hub.docker.com/r/pallavagarwal07/gentoo-stabilization/~/dockerfile/



